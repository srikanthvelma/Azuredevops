# dotnet reusable template for dotnet projects
parameters:
  - name: 'command'
    displayName: command
    type: string
    default: 'build'
    values:
      - 'push'
      - 'pack'
      - 'publish'
      - 'restore'
      - 'test'

  - name: projects
    displayName: "projects"
    type: string
    default: 'src/NopCommerce.sln'

  - name: 'publishWebProjects'
    displayName: "publish web projects"
    type: boolean
    default: 'true'
    values: 
      - 'false'

  - name: 'zipAfterPublish'
    displayName: "zip after pubish"
    type: boolean
    default: 'true'
    values: 
      - 'false'

  - name: 'ArtifactName'
    displayName: "artifact name"
    type: string
    default: 'srwebapp'

steps:
  - task: DotNetCoreCLI@2
    inputs:
      command: 'build'
      projects: 'src/NopCommerce.sln'
  - task: DotNetCoreCLI@2
    inputs:
      command: "publish"
      publishWebProjects: "${{ parameters.publishWebProjects }}"
      arguments: '--configuration Release --output $(Build.ArtifactStagingDirectory)'
      zipAfterPublish: "${{ parameters.zipAfterPublish }}"
      packagesToPack: '**/*.csproj'

  - task: PublishPipelineArtifact@1
    inputs:
      targetPath: '$(Build.ArtifactStagingDirectory)'
      ArtifactName: "${{ parameters.ArtifactName }}"
    